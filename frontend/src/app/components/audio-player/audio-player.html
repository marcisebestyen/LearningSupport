<div class="list-layout">
  <h2>My Audio Library</h2>

  @if (audioList().length === 0) {
    <div class="empty-state">
      <p>No audios generated yet. Go to "History" and generate one from a summary!</p>
    </div>
  }

  <div class="audio-grid">
    @for (audio of audioList(); track audio.id) {
      <div class="audio-card" [class.active]="playingDocId() === audio.id">
        <div class="card-content">
          <div class="header">
            <span class="category-tag">{{ audio.category || 'General' }}</span>
            <h3>{{ audio.filename }}</h3>
          </div>

          <div class="summary-preview">
            <p>Click play to listen to the AI-generated summary of this document.</p>
          </div>
        </div>

        <div class="audio-engine">
          @if (playingDocId() === audio.id) {
            <div class="player-controls fade-in">
              <audio #player
                     autoplay
                     [src]="audioBlobUrl()"
                     (timeupdate)="onTimeUpdate($event)"
                     (loadedmetadata)="onLoadedMetadata($event)"
                     (ended)="stopAudio()">
              </audio>

              <div class="control-row">
                <button (click)="seek(player, -10)" class="icon-btn" title="-10s">‚è™</button>

                <button (click)="togglePlay(player)" class="play-pause-btn">
                  @if (isPaused()) { <span>‚ñ∂Ô∏è</span> }
                  @else { <span>‚è∏Ô∏è</span> }
                </button>

                <button (click)="seek(player, 10)" class="icon-btn" title="+10s">‚è©</button>
              </div>

              <div class="progress-container">
                <span class="time">{{ formatTime(currentTime()) }}</span>

                <input type="range" class="seeker"
                       [max]="duration()"
                       [value]="currentTime()"
                       (input)="onSeekInput($event, player)">

                <span class="time">{{ formatTime(duration()) }}</span>
              </div>
            </div>
          } @else {
            <div class="card-actions">
              <button class="primary-btn" (click)="startAudio(audio.id)">
                <span>üîä</span> Play Summary
              </button>
            </div>
          }
        </div>
      </div>
    }
  </div>
</div>
