<div class="list-layout">
  <h2>My Audio Library</h2>

  @if (audioList().length === 0) {
    <div class="empty-state">
      <p>No audios generated yet. Go to "History" and generate one from a summary!</p>
    </div>
  }

  <div class="audio-grid">
    @for (audio of audioList(); track audio.id) {
      <div class="audio-card" [class.active]="playingDocId() === audio.id">
        <div class="card-content">
          <div class="header">
            <span class="category-tag">{{ audio.category || 'General' }}</span>
            <h3>{{ audio.filename }}</h3>
          </div>

          <div class="summary-preview">
            <p>Click play to listen to the AI-generated summary of this document.</p>
          </div>
        </div>

        <div class="audio-engine">
          @if (playingDocId() === audio.id) {
            <div class="player-controls">
              <audio #player autoplay [src]="audioBlobUrl()" (ended)="stopAudio()"></audio>

              <div class="control-row">
                <button (click)="seek(player, -10)" class="icon-btn">‚è™</button>
                <button (click)="togglePlay(player)" class="play-pause-btn">
                  {{ player.paused ? '‚ñ∂Ô∏è' : '‚è∏Ô∏è' }}
                </button>
                <button (click)="seek(player, 10)" class="icon-btn">‚è©</button>
              </div>

              <div class="progress-container">
                <div class="time">{{ player.currentTime | number:'1.0-0' }}s</div>
                <input type="range" class="seeker"
                       [max]="player.duration || 0"
                       [value]="player.currentTime"
                       (input)="onSeekInput($event, player)">
                <div class="time">{{ player.duration | number:'1.0-0' }}s</div>
              </div>
            </div>
          } @else {
            <div class="card-actions">
              <button class="primary-btn" (click)="startAudio(audio.id)">
                <span>üîä</span> Play Summary
              </button>
            </div>
          }
        </div>
      </div>
    }
  </div>
</div>
