<div class="upload-wrapper">

  @if (!selectedFile()) {
    <div class="drop-zone" appDragDrop (fileDropped)="onFileDropped($event)">
      <div class="icon">‚òÅÔ∏è</div>
      <h3>Drag & Drop your PDF here</h3>
      <p>PDF, Word (.docx) or PowerPoint (.pptx)</p>
      <p>or</p>
      <label for="fileInput" class="browse-btn">Browse Files</label>
      <input
        type="file"
        id="fileInput"
        (change)="onFileSelected($event)"
        accept=".pdf, .docx, .pptx"
        hidden
      >
    </div>
  }

  @if (selectedFile()) {
    <div class="card file-info-card">
      <div class="card-header">üìÑ Setup Upload</div>
      <div class="card-body">
        <p><strong>Name:</strong> {{ fileName() }}</p>
        <p><strong>Size:</strong> {{ fileSize() }}</p>

        <hr>

        <div class="category-section">
          <label>Category (Optional):</label>

          @if (!isAddingNewCategory()) {
            <div class="input-group">
              <select [ngModel]="selectedCategory()" (ngModelChange)="selectedCategory.set($event)">
                <option value="">-- No Category --</option>
                @for (cat of existingCategories(); track cat) {
                  <option [value]="cat">{{ cat }}</option>
                }
              </select>
              <button class="toggle-btn" (click)="toggleNewCategory()">+ New Type</button>
            </div>
          } @else {
            <div class="input-group">
              <input type="text" placeholder="Enter new type..."
                     [ngModel]="newCategoryInput()" (ngModelChange)="newCategoryInput.set($event)">
              <button class="toggle-btn secondary" (click)="toggleNewCategory()">Cancel</button>
            </div>
          }
        </div>

        <div class="actions">
          <button class="upload-btn" (click)="startUpload()" [disabled]="isLoading()">
            {{ isLoading() ? 'Uploading...' : 'üöÄ Start Upload' }}
          </button>
          <button class="cancel-btn" (click)="selectedFile.set(null)" [disabled]="isLoading()">Cancel</button>
        </div>

      </div>
    </div>
  }

</div>
